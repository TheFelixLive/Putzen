<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Person-Zuordnung basierend auf Unix-Zeit und Woche</title>
  <script>
    // Listen von Personen und Räumen
    const personen = ['person_0', 'person_1', 'person_2', 'person_3', 'person_4'];
    const raeume = ['room_0', 'room_1', 'room_2', 'room_3', 'room_4'];

    // Berechnet die Kalenderwoche basierend auf dem Datum
    function getISOWeek(date) {
        const respinday = 5;
        const tempDate = new Date(date.getTime());
        tempDate.setDate(tempDate.getDate() - tempDate.getDay() + respinday); // Setze auf den ersten Montag
        const firstMonday = new Date(tempDate.getFullYear(), 0, 1);
        const dayOfYear = Math.floor((tempDate - firstMonday) / (1000 * 3600 * 24));
        return Math.floor(dayOfYear / 7) + respinday;
    }

    // Berechnet die Person basierend auf dem aktuellen Datum und der Woche
    function getPersonBasedOnTimeAndRoom(room) {
        const unixTimestamp = Math.floor(Date.now() / 1000);  // Unix-Zeit in Sekunden
        const date = new Date(unixTimestamp * 1000);  // Unix-Zeitstempel in Datum umwandeln
        const currentWeek = getISOWeek(date);  // Korrekte Kalenderwoche berechnen
        const roomIndex = raeume.indexOf(room);  // Finde den Index des Raums in der Liste
        const personIndex = (roomIndex + currentWeek) % personen.length;  // Berechne den Person-Index je nach Woche

        return personen[personIndex];
    }



    // Funktion für die manuelle Eingabe eines Raums
    function handleRoomInput() {
      const roomInput = document.getElementById("roomInput").value;
      if (raeume.includes(roomInput)) {
        const person = getPersonBasedOnTimeAndRoom(roomInput);
        
        document.getElementById("output").innerText = `Zugewiesene Person für ${roomInput}: ${person}`;
      } else {
        document.getElementById("output").innerText = "Ungültiger Raum!";
      }
    }
  </script>
</head>
<body>
  <h1>Person-Zuordnung basierend auf Unix-Zeit und Kalenderwoche</h1>

  <label for="roomInput">Raum auswählen:</label>
  <input type="text" id="roomInput" placeholder="room_0 bis room_4" />
  <button onclick="handleRoomInput()">Person anzeigen</button>

  <p id="output"></p>

</body>
</html>